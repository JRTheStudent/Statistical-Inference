---
output: 
  html_document:
    keep_md: true
---

## Exponential Distribution Vs. the Central Limit Theorem

## Overview
This project explores the contrast between the observed and estimated means and variances of a large collection of randomly simulated exponential variables. This is achieved by comparing mean and variance values estimated by the Central Limit Theorem (CLT) to those observed through random simulation.

## Simulations

#### Load Required Libraries
```{r "libraries", message = F, warning = F}}
library(grid)       # Plotting graphics (arrow)
library(ggplot2)    # Plotting (qplot)
```


#### Set Variables and Simulate Data
```{r}
set.seed(123)
n <- 40
lambda <- 0.2
nSim <- 1000

exps <- NULL
means <- NULL
vars <- NULL

for (i in 1:nSim){
    exp <- rexp(n, lambda)
    exps <- cbind(exps, exp)
    means <- c(means, mean(exp))
    vars <- c(vars, sd(exp) ^ 2)
}

tMean <- 1 / lambda
tSD <- 1 / lambda
tVar <- tSD ^ 2
```

The data were produced via 1,000 simulations (*nSim*) each generating 40 observations (*n*) of random exponentials using a rate of 0.2 (*lambda*). These values are applied via iteration of a loop to populate values of the expnonentials (*exps*) and means (*means*). Per the CLT both the estimated mean (*tMean*) and the estimated standard deviaion (*tSD*) are (1/lambda) = (1/0.2) = 5.0.  Theoretical variance (*tVar*) is simply the square of the theoretical standard deviation (5.0^2 = 25).  

## Sample Mean Vs. Theoretical Mean

1. Show the sample mean and compare it to the theoretical mean of the distribution.
Sample Mean versus Theoretical Mean: Include figures with titles. In the figures, highlight the means you are comparing. Include text that explains the figures and what is shown on them, and provides appropriate numbers.

```{r "sampleVtheoryMean"}
plot1 <- ggplot(
    as.data.frame(means)
    ,aes(x = means)
) + geom_histogram(
    alpha = .20
    ,binwidth = (range(means)[2] - range(means)[1]) / 20
    ,color = "black"
    ,aes(y = ..density..)    
) + geom_vline( # Sample distribution mean line
    xintercept = mean(means)
) + geom_segment( # Sample distribution mean arrow
    aes(
        x = mean(means) + 1
        ,xend = mean(means)
        ,y = max(density(means)$y)
        ,yend = max(density(means)$y) 
    )
    ,arrow = arrow(length = unit(.1,"in"), ends = "last")
) + geom_text( # Sample distribution mean label
    aes(
        x = mean(means) + 1
        ,y = max(density(means)$y)
        ,label = paste(
            "Sample distribution\nwith mean of"
            ,sprintf("%.5f", mean(means))
        )
    )
    ,color = "black"
    ,size = 4
    ,hjust = 0    
) + stat_function(
    fun = dnorm
    ,arg = list(mean = tSD)
    ,color = "red"
) + geom_vline( # Theoretical distribution variability line
    xintercept = tSD
    ,color = "red"
) + geom_segment( # Theoretical distribution variability arrow
    aes(
        x = tSD + 1
        ,xend = tSD
        ,y = .4
        ,yend = .4 
    )
    ,arrow = arrow(length = unit(.1,"in"), ends = "last")
    ,color = "red"
) + geom_text( # Theoretical distribution mean label
    aes(
        x = mean(means) + 1
        ,y = .4
        ,label = paste(
            "Theoretical distribution\nwith mean of"
            ,sprintf("%.5f",tMean)
        )
    )
    ,color = "red"
    ,size = 4
    ,hjust = 0    
) + labs(
    title = "Density of Exponential Sample\nvs. Theoretical Means"
    ,x = "Sample Means"
    ,y = "Density"
)
print(plot1)
```

## Sample Vaiance s. Theoretical Variance
```{r "sampleVtheoryVary"}
plot2 <- ggplot(
    as.data.frame(vars)
    ,aes(x = vars)
) + geom_histogram(
    alpha = .20
    ,binwidth = (range(vars)[2] - range(vars)[1]) / 20
    ,color = "black"
    ,aes(y = ..density..)    
) + geom_vline( # Sample distribution mean line
    xintercept = mean(vars)
) + geom_segment( # Sample distribution mean arrow
    aes(
        x = mean(vars) + 1
        ,xend = mean(vars)
        ,y = max(density(vars)$y)
        ,yend = max(density(vars)$y) 
    )
    ,arrow = arrow(length = unit(.1,"in"), ends = "last")
) + geom_text( # Sample distribution variability label
    aes(
        x = mean(vars) + 1
        ,y = max(density(vars)$y)
        ,label = paste(
            "Sample distribution\nwith variability mean of"
            ,sprintf("%.5f", mean(vars))
        )
    )
    ,color = "black"
    ,size = 4
    ,hjust = 0    
) + stat_function(
    fun = dnorm
    ,arg = list(mean = tVar)
    ,color = "red"
) + geom_vline( # Theoretical distribution variability line
    xintercept = tVar
    ,color = "red"
) + geom_segment( # Theoretical distribution variability arrow
    aes(
        x = tVar + 1
        ,xend = tVar
        ,y = .1
        ,yend = .1 
    )
    ,arrow = arrow(length = unit(.1,"in"), ends = "last")
    ,color = "red"
) + geom_text( # Theoretical distribution mean label
    aes(
        x = mean(vars) + 1
        ,y = .1
        ,label = paste(
            "Theoretical distribution\nwith mean of"
            ,sprintf("%.5f",tVar)
        )
    )
    ,color = "red"
    ,size = 4
    ,hjust = 0    
) + labs(
    title = "Density of Exponential Sample\nvs. Theoretical Variability"
    ,x = "Sample Variability"
    ,y = "Density"
)
print(plot2)
```

## Distribution
Show that the distribution is approximately normal.
Focus on the difference between the distribution of a large collection of random exponentials and the distribution of a large collection of averages of 40 exponentials. 

Via figures and text, explain how one can tell the distribution is approximately normal.

```{r "distribution"}
plot3 <- qplot(
    means
    ,geom = "density"
    ,main = "Density of Means for Exponential Variables:\nSample vs. Theoretical Values"
    ,xlab = "Sample Mean"
    ,ylab = "Density"
) + geom_vline( # Sample distribution mean line
    xintercept = mean(means)
) + geom_segment( # Sample distribution mean arrow
    aes(
        x = mean(means) + 1
        ,xend = mean(means)
        ,y = max(density(means)$y)
        ,yend = max(density(means)$y) 
    )
    ,arrow = arrow(length = unit(.1,"in"), ends = "last")
) + geom_text( # Sample distribution mean label
    aes(
        x = mean(means) + 1
        ,y = max(density(means)$y)
        ,label = paste(
            "Sample distribution\nwith mean of"
            ,sprintf("%.5f", mean(means))
        )
    )
    ,color = "black"
    ,size = 4
    ,hjust = 0
) + stat_function( # Theoretical (normal) distribution
    fun = dnorm
    ,color = "red"
    ,arg = list(mean = tMean)
) + geom_vline( # Theoretical distribution mean line
    xintercept = tMean
    ,color = "red"
) + geom_segment( # Theoretical distribution mean arrow
    aes(
        x = tMean + 1
        ,xend = tMean
        ,y = .4
        ,yend = .4 
    )
    ,arrow = arrow(length = unit(.1,"in"), ends = "last")
    ,color = "red"
) + geom_text( # Theoretical distribution mean label
    aes(
        x = tMean + 1
        ,y = .4
        ,label = paste(
            "Theoretical distribution\nwith mean of"
            ,sprintf("%.5f",tMean)
        )
    )
    ,color = "red"
    ,size = 4
    ,hjust = 0
)
print(plot3)
```


The CLT states that averages are approximately normal, with distributions
centered at the population mean and 
with standard deviation equal to the standard error of the mean